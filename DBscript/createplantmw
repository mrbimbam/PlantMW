CREATE DATABASE plantmw;
USE plantmw;

CREATE TABLE Countries (
	CountryID BIGINT AUTO_INCREMENT,
	CountryName VARCHAR(80),
	PRIMARY KEY(CountryID)
);
CREATE TABLE States (
	StateID BIGINT AUTO_INCREMENT,
	CountryID BIGINT,
	StateName VARCHAR(80),
	PRIMARY KEY(StateID),
	FOREIGN KEY(CountryID) REFERENCES Countries(CountryID)
);
CREATE TABLE PostalCodes (
	PostalCodeID BIGINT AUTO_INCREMENT, 
	StateID BIGINT, 
	PostalCode VARCHAR(8),
	PRIMARY KEY(PostalCodeID),
	FOREIGN KEY(StateID) References States(StateID)
);


CREATE TABLE Owner(
	OwnerID BIGINT AUTO_INCREMENT,
	Email VARCHAR(120),
	Firstname VARCHAR(120),
	LastName VARCHAR(120),
	UserName VARCHAR(120),
	Geolocation VARCHAR(120),
	Address1 VARCHAR(120),
	Address2 VARCHAR(120),
	Phone VARCHAR(20),
	PostalCodeID BIGINT,
	StateID BIGINT,
	CountryID BIGINT,
	RegDate DATETIME,
	PRIMARY KEY(OwnerID),
	FOREIGN KEY(PostalCodeID) REFERENCES PostalCodes(PostalCodeID),
	FOREIGN KEY(StateID) REFERENCES States(StateID),
	FOREIGN KEY(CountryID) REFERENCES Countries(CountryID)
);

CREATE TABLE Hash(
	PasswordID BIGINT,
	OwnerID BIGINT,
	PasswordHash BLOB,
	FOREIGN KEY(OwnerID) REFERENCES Owner(OwnerID)	
);

CREATE TABLE MessageThread(
	ThreadID BIGINT AUTO_INCREMENT,
	OwnerID BIGINT,
	Date DATETIME,
	PRIMARY KEY(ThreadID),
	FOREIGN KEY(OwnerID) REFERENCES Owner(OwnerID)
);

CREATE TABLE Message(
	MessageID BIGINT AUTO_INCREMENT,
	ThreadID BIGINT,
	OwnerID BIGINT,
	Date DATETIME,
	Message VarChar(255),
	Data VARCHAR(255),
	PRIMARY KEY(MessageID),
	FOREIGN KEY(ThreadID) REFERENCES MessageThread(ThreadID),
	FOREIGN KEY(OwnerID) REFERENCES Owner(OwnerID)
);

CREATE TABLE Manufacturer(
	ManufacturerID BIGINT AUTO_INCREMENT,
	OwnerID BIGINT,
	Name VARCHAR(120),
	Email VARCHAR(120),
	Geolocation VARCHAR(120),
	Streetname VARCHAR(120),
	Address VARCHAR(120),
	Phone VARCHAR(20),
	PostalCodeID BIGINT,
	StateID BIGINT,
	CountryID BIGINT,
	DateRegisterd DateTime,
	PRIMARY KEY(ManufacturerID),
	FOREIGN KEY(OwnerID) REFERENCES Owner(OwnerID),
	FOREIGN KEY(PostalCodeID) REFERENCES PostalCodes(PostalCodeID),
	FOREIGN KEY(StateID) REFERENCES States(StateID),
	FOREIGN KEY(CountryID) REFERENCES Countries(CountryID)
);

CREATE TABLE Product(
	ProductID BIGINT AUTO_INCREMENT,
	ManufacturerID BIGINT,
	ProductName VARCHAR(120),
	PRIMARY KEY(ProductID),
	FOREIGN KEY(ManufacturerID) REFERENCES Manufacturer(ManufacturerID)
);

CREATE TABLE Thing(
	ThingID BIGINT AUTO_INCREMENT,
	OwnerID BIGINT,
	ProductID BIGINT,
	SerialNumber VARCHAR(32),
	Geolocation VARCHAR(120),
	Name VARCHAR(120),
	DateRegistered DATETIME,
	PRIMARY KEY(ThingID),
	FOREIGN KEY(OwnerID) REFERENCES Owner(OwnerID),
	FOREIGN KEY(ProductID) REFERENCES Product(ProductID)
);

CREATE TABLE ThingEvent(
	EventID BIGINT AUTO_INCREMENT,
	ThingId BIGINT,
	EventDate DATETIME,
	Event VARCHAR(255),
	Data BLOB,
	PRIMARY KEY(EventID),
	FOREIGN KEY(ThingID) REFERENCES Thing(ThingID)
);


CREATE TABLE ThirdParty(
	TPID BIGINT AUTO_INCREMENT,
	OwnerID BIGINT,
	Name VARCHAR(120),
	Email VARCHAR(120),
	Geolocation VARCHAR(120),
	Streetname VARCHAR(120),
	Address1 VARCHAR(120),
	Address2 VARCHAR(120),
	Phone VARCHAR(20),
	PostalCodeID BIGINT,
	StateID BIGINT,
	CountryID BIGINT,
	PRIMARY KEY(TPID),
	FOREIGN KEY(OwnerID) REFERENCES Owner(OwnerID),
	FOREIGN KEY(PostalCodeID) REFERENCES PostalCodes(PostalCodeID),
	FOREIGN KEY(StateID) REFERENCES States(StateID),
	FOREIGN KEY(CountryID) REFERENCES Countries(CountryID)
);



SHOW TABLES;